using Nemerle.Collections;
using Nemerle.Xml;
using Nemerle.Extensions;
using Nemerle.ComputationExpressions;

using System;
using System.Text;
using System.Linq;
using System.Console;
using System.Collections.Generic;
using System.Xml.Linq;

using NemerleWeb;

module Program
{
  Main() : void
  {
    def result = nweb Test();
    WriteLine(result);
    _ = Console.ReadKey();
  }
}


[Unit]
public class Test
{  
  /*public InstanceRef(s : ref string) : string
  {
    InstanceDoRef(ref s);
    s + "b"
  }
      
  private InstanceDoRef(s : ref string) : void
  {
    s = "a";
  }*/
      
  //public InstanceOut(x : out int) : int
  //{
  //  InstanceDoOut(out x);
  //  x + 1
  //}
      
  //private InstanceDoOut(x : out int) : void
  //{
  //  x = 1;
  //}
  
  //public static StaticRef(s : ref string) : string
  //{
  //  StaticDoRef(ref s);
  //  s + "b"
  //}
      
  //private static StaticDoRef(s : ref string) : void
  //{
  //  s = "a";
  //}
      
  //public static StaticOut(x : out int) : int
  //{
  //  StaticDoOut(out x);
  //  x + 1
  //}
      
  //private static StaticDoOut(x : out int) : void
  //{
  //  x = 1;
  //}
      
  public this()
  {    
    def g(pos, x) { pos - x }
    def h(pos, x) { pos + x }
        
    def f(pos : int)
    {
      def pos = g(pos, 1);
      if (pos >= 0)
      {
        def pos = h(pos, 2);
        if (pos >= 0)
          pos
        else
          -1
      }
      else
        -1
    }
        
    f(2) == 3
  }
    
  [Html]
  public View() : string
  {
    <# <div></div> #>
  }
}