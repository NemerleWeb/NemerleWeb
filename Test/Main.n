using Nemerle.Collections;
using Nemerle.Xml;
using Nemerle.Extensions;
using Nemerle.ComputationExpressions;

using System;
using System.Text;
using System.Linq;
using System.Console;
using System.Collections.Generic;
using System.Xml.Linq;

using NemerleWeb;

module Program
{
  Main() : void
  {
    def result = nweb Test();
    WriteLine(result);
    _ = Console.ReadKey();
  }
}


[Unit]
public class Test
{    
  [Unit]
  variant VariantWithListTuple
  {
    | A { X : list[B * string]; }
    | B { Y : int; }
  }
  
  public this()
  {    
  }
  
  public T() : bool
  {

    def f(a)
    {
      match (a)
      {
      | VariantWithListTuple.A(l) =>
        mutable count;
        foreach (i in l)
          count += f(i[0]);
        count
      | VariantWithListTuple.B => 1
      }
    }
        
    def a = VariantWithListTuple.A([(VariantWithListTuple.B(1), "A"), (VariantWithListTuple.B(2), "B")]);
    f(a) == 2
  }

  [Html]
  public View() : string
  {
    <# <div></div> #>
  }
}